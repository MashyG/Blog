
# HTTP 缓存

## 强缓存

> **强缓存** 在失效时间内，不走服务器，只走本地缓存

- **expires：设置毫秒数**

```js
// 30秒内使用本地缓存
set('Expires', new Data(Date.now() + 30000).toUTCString())
```

- **cache-control（优先级更高）：设置 max-age (秒数)**

```js
// 30秒内使用本地缓存
set('Cache-Control', 'max-age=30')
```

## 协商缓存

> **协商缓存** 要走服务器，在请求服务器时发现命中缓存则返回**304**，否则返回已请求的资源

- Last-Modified，if-Modified-Since

过程：

- 第一次请求资源时，服务端会把所请求的资源的**最后一次修改时间**当成响应头中 **Last-Modified** 的值发到浏览器并在浏览器存起来
- 第二次请求资源时，浏览器会把刚刚存储的时间当成请求头中 **If-Modified-Since** 的值，传到服务端，服务端拿到这个时间跟所请求的资源的最后修改时间进行比对
- 比对结果如果两个时间相同，则说明此资源没修改过，那就是 **命中缓存**，那就返回 **304**，如果不相同，则说明此资源修改过了，则 **没命中缓存**，则返回修改过后的新资源

- Etag，If-None-Match（优先级更高）
